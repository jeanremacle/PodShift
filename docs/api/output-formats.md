# Output Formats and JSON Schemas

Complete documentation of all output formats, JSON schemas, and data structures generated by PodShift.

> **Navigation**: [‚Üê Configuration Options](configuration-options.md) | [Script Reference](script-reference.md)

**Related Documentation:**
- [Script Reference](script-reference.md) - Command-line options that control output
- [Configuration Options](configuration-options.md) - Output configuration settings
- [Discovery Process](../migration-guide/discovery-process.md) - Understanding discovery output
- [Migration Planning](../migration-guide/migration-planning.md) - Using output for planning
- [Common Issues](../troubleshooting/common-issues.md) - Output format troubleshooting

## Table of Contents

1. [Overview](#overview)
2. [Docker Inventory Schema](#docker-inventory-schema)
3. [Dependency Mapping Schema](#dependency-mapping-schema)
4. [System Resources Schema](#system-resources-schema)
5. [Discovery Report Schema](#discovery-report-schema)
6. [Common Data Types](#common-data-types)
7. [Schema Validation](#schema-validation)
8. [Output Examples](#output-examples)

## Overview

PodShift generates structured JSON output for programmatic consumption and human-readable text reports for review. All JSON output follows defined schemas for consistency and integration.

### Output File Types

| File Pattern | Schema | Description |
|--------------|---------|-------------|
| `docker_inventory_*.json` | [Docker Inventory](#docker-inventory-schema) | Complete Docker resource catalog |
| `container_dependencies_*.json` | [Dependency Mapping](#dependency-mapping-schema) | Container relationships and migration sequence |
| `system_resources_*.json` | [System Resources](#system-resources-schema) | Apple Silicon Mac system analysis and recommendations |
| `docker_discovery_report_*.json` | [Discovery Report](#discovery-report-schema) | Comprehensive discovery summary |
| `docker_discovery_summary_*.txt` | Text Format | Human-readable executive summary |

### Common Schema Patterns

All JSON outputs follow these conventions:

```json
{
  "metadata": {
    "timestamp": "YYYYMMDD_HHMMSS",
    "generated_at": "ISO8601_datetime",
    "script_version": "semantic_version",
    "hostname": "system_hostname"
  },
  "data": { /* schema-specific content */ },
  "statistics": { /* summary counts and metrics */ }
}
```

## Docker Inventory Schema

### Root Structure

```json
{
  "metadata": {
    "timestamp": "string",
    "generated_at": "string (ISO8601)",
    "script_version": "string",
    "docker_version": "DockerVersion",
    "system_info": "SystemInfo"
  },
  "containers": ["Container"],
  "images": ["Image"],
  "volumes": ["Volume"],
  "networks": ["Network"],
  "statistics": "InventoryStatistics",
  "apple_silicon_compatibility": "AppleSiliconCompatibility"
}
```

### Container Schema

```json
{
  "id": "string (short ID)",
  "full_id": "string (full SHA256)",
  "name": "string",
  "image": "string (image name/tag)",
  "image_id": "string (short ID)",
  "status": "string (running|exited|paused|restarting|removing|dead)",
  "created": "string (ISO8601)",
  "started_at": "string (ISO8601)|null",
  "finished_at": "string (ISO8601)|null",
  "exit_code": "integer|null",
  "restart_count": "integer",
  "platform": "string",
  
  "config": {
    "hostname": "string|null",
    "user": "string|null",
    "exposed_ports": ["string"],
    "environment": ["string"],
    "command": ["string"]|null,
    "entrypoint": ["string"]|null,
    "working_dir": "string|null",
    "labels": {"string": "string"},
    "stop_signal": "string|null",
    "shell": ["string"]|null
  },
  
  "host_config": {
    "port_bindings": {"string": [{"HostPort": "string"}]},
    "binds": ["string"],
    "volumes_from": ["string"],
    "network_mode": "string|null",
    "restart_policy": {
      "Name": "string",
      "MaximumRetryCount": "integer"
    },
    "memory": "integer (bytes)",
    "memory_swap": "integer (bytes)",
    "cpu_shares": "integer",
    "cpu_period": "integer",
    "cpu_quota": "integer",
    "cpuset_cpus": "string|null",
    "privileged": "boolean",
    "pid_mode": "string|null",
    "ipc_mode": "string|null",
    "security_opt": ["string"],
    "cap_add": ["string"],
    "cap_drop": ["string"]
  },
  
  "network_settings": {
    "networks": {"string": "NetworkEndpoint"},
    "ports": {"string": [{"HostIp": "string", "HostPort": "string"}]|null},
    "ip_address": "string",
    "gateway": "string",
    "sandbox_id": "string"
  },
  
  "mounts": [{
    "type": "string (bind|volume|tmpfs)",
    "source": "string|null",
    "destination": "string",
    "mode": "string",
    "rw": "boolean",
    "propagation": "string|null",
    "name": "string|null",
    "driver": "string|null"
  }],
  
  "stats": "ContainerStats|null",
  "apple_silicon_compatibility": "ContainerAppleSiliconCompatibility"
}
```

### Image Schema

```json
{
  "id": "string (short ID)",
  "full_id": "string (full SHA256)",
  "tags": ["string"],
  "created": "string (ISO8601)",
  "size": "integer (bytes)",
  "virtual_size": "integer (bytes)",
  "architecture": "string (amd64|arm64|unknown)",
  "os": "string",
  "parent": "string",
  "docker_version": "string",
  "author": "string",
  "comment": "string",
  
  "config": {
    "hostname": "string|null",
    "user": "string|null",
    "exposed_ports": ["string"],
    "environment": ["string"],
    "command": ["string"]|null,
    "entrypoint": ["string"]|null,
    "working_dir": "string|null",
    "labels": {"string": "string"},
    "stop_signal": "string|null",
    "shell": ["string"]|null,
    "volumes": ["string"]
  },
  
  "layers": "integer",
  "history": ["ImageHistoryEntry"],
  "dangling": "boolean",
  "apple_silicon_compatibility": {
    "architecture": "string",
    "platforms": ["string"],
    "native_arm64": "boolean",
    "emulation_required": "boolean",
    "multi_arch": "boolean"
  }
}
```

### Volume Schema

```json
{
  "name": "string",
  "short_id": "string",
  "created": "string (ISO8601)",
  "driver": "string",
  "mountpoint": "string",
  "scope": "string (local|global)",
  "labels": {"string": "string"},
  "options": {"string": "string"},
  
  "used_by": [{
    "container_name": "string",
    "container_id": "string",
    "mount_destination": "string",
    "read_write": "boolean"
  }],
  "in_use": "boolean",
  "size_bytes": "integer"
}
```

### Network Schema

```json
{
  "id": "string (short ID)",
  "full_id": "string (full SHA256)",
  "name": "string",
  "created": "string (ISO8601)",
  "scope": "string (local|global|swarm)",
  "driver": "string",
  "enable_ipv6": "boolean",
  "internal": "boolean",
  "attachable": "boolean",
  "ingress": "boolean",
  "config_from": {"Network": "string"},
  "config_only": "boolean",
  "labels": {"string": "string"},
  
  "ipam": {
    "driver": "string",
    "config": [{
      "Subnet": "string",
      "Gateway": "string",
      "IPRange": "string|null"
    }],
    "options": {"string": "string"}
  },
  
  "connected_containers": [{
    "container_id": "string",
    "name": "string",
    "endpoint_id": "string",
    "mac_address": "string",
    "ipv4_address": "string",
    "ipv6_address": "string|null"
  }],
  
  "options": {"string": "string"},
  "is_custom": "boolean"
}
```

### Apple Silicon Compatibility Schema

```json
{
  "overall_compatibility_score": "number (0-100)",
  "arm64_images": "integer",
  "amd64_images": "integer", 
  "multi_arch_images": "integer",
  "unknown_arch_images": "integer",
  "potential_issues": [{
    "category": "string",
    "issue": "string",
    "severity": "string (low|medium|high|critical)",
    "affected_containers": ["string"]|null,
    "affected_images": ["string"]|null,
    "recommendation": "string"
  }]
}
```

## Dependency Mapping Schema

### Root Structure

```json
{
  "metadata": {
    "timestamp": "string",
    "generated_at": "string (ISO8601)",
    "script_version": "string"
  },
  "containers": {"string": "ContainerDependencies"},
  "networks": {"string": "NetworkInfo"},
  "volumes": {"string": "VolumeInfo"},
  "compose_services": {"string": "ComposeServiceInfo"},
  "dependency_graph": "DependencyGraph",
  "migration_sequence": "MigrationSequence"
}
```

### Container Dependencies Schema

```json
{
  "id": "string",
  "status": "string",
  "depends_on": ["string"],
  "depended_by": ["string"],
  "network_dependencies": [{
    "container": "string",
    "network": "string",
    "type": "string"
  }],
  "volume_dependencies": [{
    "container": "string",
    "volume": "string|null",
    "bind_source": "string|null",
    "type": "string (volume_shared|bind_shared)",
    "source_path": "string",
    "target_path": "string"
  }],
  "link_dependencies": [{
    "container": "string",
    "link": "string",
    "type": "string"
  }],
  "environment_dependencies": [{
    "container": "string",
    "environment_variable": "string",
    "value": "string",
    "type": "string"
  }],
  "startup_order": "integer",
  "migration_priority": "string (low|normal|high|critical)"
}
```

### Dependency Graph Schema

```json
{
  "nodes": ["string"],
  "edges": [{
    "from": "string",
    "to": "string", 
    "type": "string (depends_on|network_shared|volume_shared)"
  }],
  "cycles": [["string"]],
  "startup_order": ["string"]
}
```

### Migration Sequence Schema

```json
{
  "phases": [{
    "name": "string",
    "containers": ["string"],
    "parallel": "boolean",
    "description": "string",
    "special": "boolean|null",
    "cycles": [["string"]]|null
  }],
  "parallel_groups": [{
    "phase": "integer",
    "containers": ["string"],
    "reason": "string"
  }],
  "sequential_order": ["string"],
  "total_phases": "integer",
  "estimated_duration": {
    "total_containers": "integer",
    "estimated_sequential_minutes": "integer",
    "estimated_parallel_minutes": "integer",
    "estimated_sequential_hours": "number",
    "estimated_parallel_hours": "number",
    "time_savings_percent": "number"
  }
}
```

## System Resources Schema

### Root Structure

```json
{
  "metadata": {
    "timestamp": "string",
    "generated_at": "string (ISO8601)",
    "script_version": "string",
    "hostname": "string",
    "script_path": "string"
  },
  "architecture": "ArchitectureInfo",
  "cpu": "CPUInfo",
  "memory": "MemoryInfo",
  "storage": "StorageInfo",
  "operating_system": "OSInfo",
  "virtualization": "VirtualizationInfo",
  "system_limits": "SystemLimitsInfo",
  "recommendations": "RecommendationsInfo",
  "podman_readiness": "ReadinessInfo"
}
```

### Architecture Info Schema

```json
{
  "architecture": "string (arm64|x86_64)",
  "is_apple_silicon": "boolean",
  "cpu_brand": "string",
  "cpu_model": "string (Apple M1|Apple M2|Apple M3|etc)",
  "podman_native_support": "boolean"
}
```

### CPU Info Schema

```json
{
  "total_cores": "integer",
  "physical_cores": "integer",
  "logical_cores": "integer",
  "performance_cores": "integer",
  "efficiency_cores": "integer",
  "recommended_cpu_limit": "integer",
  "cpu_utilization_percent": "integer (75)",
  "l1_cache_size": "integer (bytes)",
  "l2_cache_size": "integer (bytes)",
  "l3_cache_size": "integer (bytes)",
  "cpu_frequency_max": "integer (Hz)"
}
```

### Memory Info Schema

```json
{
  "total_memory_bytes": "integer",
  "total_memory_gb": "integer",
  "recommended_memory_limit_gb": "integer",
  "recommended_memory_limit_bytes": "integer",
  "memory_utilization_percent": "integer (75)",
  "available_memory_gb": "integer",
  "memory_free_percent": "integer",
  "memory_adequate": "boolean",
  "memory_status": "string (insufficient|minimal|adequate)",
  "memory_type": "string",
  "minimum_required_gb": "integer",
  "recommended_gb": "integer"
}
```

### Storage Info Schema

```json
{
  "total_space_gb": "integer",
  "available_space_gb": "integer",
  "used_percent": "integer",
  "storage_adequate": "boolean",
  "storage_status": "string (insufficient|minimal|adequate)",
  "storage_type": "string (SSD|HDD|Unknown)",
  "storage_device": "string",
  "minimum_required_gb": "integer",
  "recommended_gb": "integer"
}
```

### Recommendations Schema

```json
{
  "recommendations": ["string"],
  "warnings": ["string"],
  "critical_issues": ["string"],
  "overall_readiness": "string (ready|not_ready)",
  "readiness_score": "integer (0-100)"
}
```

## Discovery Report Schema

### Root Structure

```json
{
  "discovery_metadata": {
    "timestamp": "string",
    "script_version": "string",
    "discovery_date": "string (ISO8601)",
    "system_architecture": "string",
    "operating_system": "string",
    "hostname": "string"
  },
  "docker_status": {
    "installed": "boolean",
    "running": "boolean",
    "version": "string"
  },
  "discovery_files": {
    "containers": "string (filename)",
    "images": "string (filename)",
    "volumes": "string (filename)",
    "networks": "string (filename)",
    "compose_files": "string (filename)",
    "system_resources": "string (filename)",
    "dependencies": "string (filename)",
    "inventory": "string (filename)"
  },
  "log_file": "string (filename)"
}
```

## Common Data Types

### Container Stats

```json
{
  "cpu_percent": "number",
  "memory_usage": "integer (bytes)",
  "memory_limit": "integer (bytes)",
  "memory_percent": "number",
  "network_rx_bytes": "integer",
  "network_tx_bytes": "integer",
  "block_read_bytes": "integer",
  "block_write_bytes": "integer",
  "pids": "integer"
}
```

### Network Endpoint

```json
{
  "IPAMConfig": {
    "IPv4Address": "string|null",
    "IPv6Address": "string|null"
  },
  "Links": ["string"]|null,
  "Aliases": ["string"]|null,
  "NetworkID": "string",
  "EndpointID": "string",
  "Gateway": "string",
  "IPAddress": "string",
  "IPPrefixLen": "integer",
  "IPv6Gateway": "string",
  "GlobalIPv6Address": "string",
  "GlobalIPv6PrefixLen": "integer",
  "MacAddress": "string"
}
```

### Image History Entry

```json
{
  "Id": "string",
  "Created": "integer (unix timestamp)",
  "CreatedBy": "string",
  "Tags": ["string"]|null,
  "Size": "integer (bytes)",
  "Comment": "string"
}
```

## Schema Validation

### JSON Schema Files

The toolkit provides JSON Schema files for validation:

```bash
# Schema validation using jsonschema
pip install jsonschema

# Validate docker inventory output
jsonschema -i docker_inventory_20240104_120000.json \
           schemas/docker-inventory-schema.json

# Validate dependency mapping output  
jsonschema -i container_dependencies_20240104_120000.json \
           schemas/dependency-mapping-schema.json

# Validate system resources output
jsonschema -i system_resources_20240104_120000.json \
           schemas/system-resources-schema.json
```

### Schema Validation Script

```python
#!/usr/bin/env python3
"""
validate_output.py - Validate toolkit output against schemas
"""

import json
import jsonschema
from pathlib import Path

def validate_file(json_file: str, schema_file: str) -> bool:
    """Validate JSON file against schema."""
    try:
        with open(json_file) as f:
            data = json.load(f)
        
        with open(schema_file) as f:
            schema = json.load(f)
        
        jsonschema.validate(data, schema)
        print(f"‚úÖ {json_file} is valid")
        return True
        
    except jsonschema.ValidationError as e:
        print(f"‚ùå {json_file} validation error: {e.message}")
        return False
    except Exception as e:
        print(f"‚ùå Error validating {json_file}: {e}")
        return False

if __name__ == "__main__":
    schemas = {
        "docker_inventory_*.json": "schemas/docker-inventory-schema.json",
        "container_dependencies_*.json": "schemas/dependency-mapping-schema.json", 
        "system_resources_*.json": "schemas/system-resources-schema.json"
    }
    
    for pattern, schema_file in schemas.items():
        for json_file in Path(".").glob(pattern):
            validate_file(str(json_file), schema_file)
```

## Output Examples

### Docker Inventory Example

```json
{
  "metadata": {
    "timestamp": "20240104_120000",
    "generated_at": "2024-01-04T12:00:00.000Z",
    "script_version": "1.0.0",
    "docker_version": {
      "version": "24.0.6",
      "api_version": "1.43",
      "os": "linux",
      "arch": "arm64"
    }
  },
  "containers": [
    {
      "id": "abc123456789",
      "name": "web-server",
      "image": "nginx:latest",
      "status": "running",
      "platform": "linux/arm64",
      "config": {
        "exposed_ports": ["80/tcp"],
        "environment": ["NGINX_HOST=localhost"]
      },
      "host_config": {
        "port_bindings": {"80/tcp": [{"HostPort": "8080"}]},
        "memory": 536870912,
        "privileged": false
      },
      "m1_compatibility": {
        "compatibility_score": 95,
        "issues": [],
        "recommended_actions": []
      }
    }
  ],
  "statistics": {
    "total_containers": 5,
    "running_containers": 3,
    "total_images": 8
  },
  "m1_compatibility": {
    "overall_compatibility_score": 87.5,
    "arm64_images": 6,
    "amd64_images": 2,
    "potential_issues": [
      {
        "category": "Architecture Compatibility",
        "issue": "Found 2 AMD64 images requiring emulation",
        "severity": "medium",
        "recommendation": "Consider ARM64 alternatives"
      }
    ]
  }
}
```

### System Resources Example

```json
{
  "metadata": {
    "timestamp": "20240104_120000",
    "generated_at": "2024-01-04T12:00:00.000Z",
    "hostname": "MacBook-Pro.local"
  },
  "architecture": {
    "architecture": "arm64",
    "is_apple_silicon": true,
    "cpu_model": "Apple M1",
    "podman_native_support": true
  },
  "cpu": {
    "total_cores": 8,
    "performance_cores": 4,
    "efficiency_cores": 4,
    "recommended_cpu_limit": 6
  },
  "memory": {
    "total_memory_gb": 16,
    "recommended_memory_limit_gb": 12,
    "memory_status": "adequate"
  },
  "recommendations": {
    "overall_readiness": "ready",
    "readiness_score": 95,
    "recommendations": [
      "Install Rosetta 2 for x86_64 compatibility",
      "Configure Podman to use 75% of system resources"
    ]
  }
}
```

---

**Integration**: These schemas enable programmatic consumption of toolkit output for automation, monitoring, and integration with other tools in your migration pipeline.

**Validation**: Always validate output against schemas before using in production automation to ensure data integrity and compatibility.